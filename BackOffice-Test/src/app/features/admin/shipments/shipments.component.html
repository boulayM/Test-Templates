<section class="container-ui page-shell">
  <header class="page-shell-header">
    <h1>Shipments</h1>
    <div class="page-shell-actions">
      <button type="button" class="btn-ui" (click)="load()">Refresh</button>
    </div>
  </header>

  <p *ngIf="loading" class="muted">Loading...</p>

  <div *ngIf="!loading" class="table-responsive">
    <table class="table-ui" *ngIf="rows.length; else emptyState">
      <thead>
        <tr>
          <th>id</th>
          <th>orderId</th>
          <th>carrier</th>
          <th>trackingNumber</th>
          <th>status</th>
          <th>shippedAt</th>
          <th>deliveredAt</th>
          <th>action</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let row of rows">
          <td>{{ rowId(row) }}</td>
          <td>{{ row['orderId'] }}</td>
          <td>{{ row['carrier'] }}</td>
          <td>{{ row['trackingNumber'] }}</td>
          <td>{{ row['status'] }}</td>
          <td>{{ row['shippedAt'] }}</td>
          <td>{{ row['deliveredAt'] }}</td>
          <td>
            <select
              [attr.data-testid]="'shipment-status-' + rowId(row)"
              [(ngModel)]="statusDrafts[+rowId(row)]"
            >
              <option *ngFor="let s of statuses" [ngValue]="s">{{ s }}</option>
            </select>
            <button
              type="button"
              class="btn-ui btn-sm"
              [attr.data-testid]="'shipment-update-' + rowId(row)"
              (click)="updateStatus(row)"
            >
              Update
            </button>
          </td>
        </tr>
      </tbody>
    </table>
    <ng-template #emptyState>
      <p class="muted">No data.</p>
    </ng-template>
  </div>
</section>