<!-- Message info pour USER -->
@if (auth.isLoggedIn() && !auth.isAdmin()) {
  <div class="ds-alert ds-alert-info activity-alert text-center">
    Pour demarrer une nouvelle activite, allez dans la page
    <strong>Contenu</strong> puis cliquez sur "Demarrer".<br />
    Vous pourrez ensuite ajouter d'autres elements a cette meme activite depuis
    cet ecran.
  </div>
}
<div class="activity-container">
  @for (activityRecord of activityRecords; track activityRecord) {
    <div class="card-ui activity-card">
      <div class="activity-header">
        <div>
          <strong>Activite #{{ activityRecord.id }}</strong>
          <span class="activity-status">({{ activityRecord.status }})</span>
        </div>
        <div>
          <!-- Bouton ajouter element -->
          <a
            class="btn-ui btn-primary btn-sm"
            [routerLink]="['/public/content']"
            [queryParams]="{ includeActivityId: activityRecord.id }"
          >
            Ajouter element
          </a>
          <!-- Bouton supprimer l activite -->
          <button
            class="btn-ui btn-secondary btn-sm"
            (click)="deleteActivityRecord(activityRecord.id)"
          >
            Supprimer activite
          </button>
        </div>
      </div>
      <div class="activity-body">
        <table class="table-ui table-compact">
          <thead>
            <tr>
              <th>Element</th>
              <th>Quantite</th>
              <th>Prix unitaire</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            @for (item of activityRecord.items; track item) {
              <tr>
                <td>{{ item.contentItem.name }}</td>
                <td>
                  <input
                    type="number"
                    min="1"
                    [(ngModel)]="item.quantity"
                    (change)="updateQuantity(activityRecord, item)"
                    class="form-control input-qty"
                  />
                </td>
                <td>{{ item.price | currency: "EUR" }}</td>
                <td>
                  <button
                    class="btn-ui btn-danger btn-sm"
                    (click)="removeItem(activityRecord.id, item.contentItemId)"
                  >
                    Retirer element
                  </button>
                </td>
              </tr>
            }
          </tbody>
        </table>
        <div class="activity-total">
          <strong>Total: {{ getTotal(activityRecord) | currency: "EUR" }}</strong>
        </div>
      </div>
    </div>
  }
</div>
