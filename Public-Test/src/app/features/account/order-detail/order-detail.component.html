<section class="order-detail">
  @if (loading) {
    <p>Chargement...</p>
  } @else if (!order) {
    <div class="ds-alert ds-alert-warning">Commande introuvable.</div>
  } @else {
    <div class="card-ui">
      <h2>Commande #{{ order.id }}</h2>
      <p>Statut: <strong>{{ order.status }}</strong></p>
      <p>Sous-total: {{ order.subtotalCents / 100 | currency: order.currency }}</p>
      <p>Livraison: {{ order.shippingCents / 100 | currency: order.currency }}</p>
      <p>Remise: -{{ order.discountCents / 100 | currency: order.currency }}</p>
      <p>Total: <strong>{{ order.totalCents / 100 | currency: order.currency }}</strong></p>
      <a class="btn-ui btn-primary btn-sm" [routerLink]="['/account/orders', order.id, 'payment']">
        Payer cette commande
      </a>
    </div>

    <div class="card-ui">
      <h3>Articles</h3>
      <ul>
        @for (item of order.items; track item.id) {
          <li>
            {{ item.productName }} (x{{ item.quantity }}) - {{ item.unitPriceCents / 100 | currency: item.currency }}
          </li>
        }
      </ul>
    </div>

    <div class="card-ui">
      <h3>Livraison</h3>
      @if (shipments.length === 0) {
        <p>Aucun suivi disponible pour cette commande.</p>
      } @else {
        <ul>
          @for (shipment of shipments; track shipment.id) {
            <li>
              {{ shipment.status }} - {{ shipment.carrier || 'Transporteur inconnu' }}
              @if (shipment.trackingNumber) {
                (tracking: <code>{{ shipment.trackingNumber }}</code>)
              }
            </li>
          }
        </ul>
      }
    </div>
  }
</section>
